<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wells Fargo | Dashboard</title>
</head>
<body>
  <h2>Welcome to Wells Fargo</h2>
  <div id="user-info">
    <p><strong>Name:</strong> <span id="name">Loading...</span></p>
    <p><strong>Email:</strong> <span id="email">Loading...</span></p>
    <p><strong>Balance:</strong> $<span id="balance">Loading...</span></p>
  </div>

  <button onclick="logout()">Logout</button>

  <script>
    const BASE_URL = 'https://backend15-nnmy.onrender.com';
    const token = localStorage.getItem('token');

    if (!token) {
      alert('Not logged in');
      window.location.href = 'login.html';
    }

    async function fetchUser() {
      const res = await fetch(`${BASE_URL}/api/auth/me`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });

      const data = await res.json();

      if (res.ok) {
        document.getElementById('name').innerText = data.name;
        document.getElementById('email').innerText = data.email;
        document.getElementById('balance').innerText = data.balance.toFixed(2);
      } else {
        alert('Session expired or unauthorized');
        window.location.href = 'login.html';
      }
    }

    function logout() {
      localStorage.removeItem('token');
      window.location.href = 'login.html';
    }

    fetchUser();
  </script>
</body>
</html>
